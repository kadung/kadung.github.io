<html>
	<head>
		<style>
			.icon {
				position: absolute;
				line-height: 0.8;
			}
			.flex-container {
				display: flex;
			}
			.flex-container div {
				width: 180px;
				height: 10px;
			}
		</style>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/xlsx.full.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/jszip.js"></script>		
	</head>

	<body>
		<div>
			<input type="file" id="my_file">
		</div>		
		<br>
		<br>
		<div id="finalResult">
			Result		
		</div>
		<hr>
		
	</body>

	<script>
		const fileInput = document.getElementById('my_file');
		const fileReader = new FileReader();
		fileReader.onload = (e) => {			
			processData(fileReader.result);
		}
		fileInput.onchange = (e) => {
			const file = event.target.files[0];
			if (!file.name.endsWith(".xlsx")) {
				alert("Please upload a valid xlsx Excel file.");
				return;
			}
			fileReader.readAsBinaryString(event.target.files[0]);
		}
  		;

		function processData(data) {
			const workbook = XLSX.read(data, {
            	type: 'binary'
        	});
 
        	//Fetch the name of First Sheet.
        	const firstSheet = workbook.SheetNames[0];

			//Read all rows from First Sheet into an JSON array.
			const excelRows = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[firstSheet]);
			console.log(excelRows);

			let tempHtml = "";
			excelRows.forEach(row => {
				if (row["Development Index"] == "-") return;
				const tdpbPadding = caculatePadding(
					row["Skill Scores - Tư duy phản biện ( Critical Thinking)"],
					row["Self-Assessment - Tư duy phản biện ( Critical Thinking)"],
				);
				const sahPadding = caculatePadding(
					row["Skill Scores - Sức ảnh hưởng"],
					row["Self-Assessment - Sức ảnh hưởng"],
				);
				const kntuPadding = caculatePadding(
					row["Skill Scores - Khả năng thích ứng"],
					row["Self-Assessment - Khả năng thích ứng"],
				);
				const lvtnPadding = caculatePadding(
					row["Skill Scores - Kỹ năng Làm việc theo nhóm"],
					row["Self-Assessment - Kỹ năng Làm việc theo nhóm"],
				);
				const gtPadding = caculatePadding(
					row["Skill Scores - Kỹ năng Giao tiếp"],
					row["Self-Assessment - Kỹ năng Giao tiếp"],
				);
				const kxPadding = caculatePadding(
					row["Skill Scores - Kỹ năng Khởi xướng"],
					row["Self-Assessment - Kỹ năng Khởi xướng"],
				);
				const tcPadding = caculatePadding(
					row["Skill Scores - Kỹ năng tổ chức"],
					row["Self-Assessment - Kỹ năng tổ chức"],
				);
				const gqvdPadding = caculatePadding(
					row["Skill Scores - Kỹ năng Giải quyết vấn đề"],
					row["Self-Assessment - Kỹ năng Giải quyết vấn đề"],
				);

				tempHtml += `
					<div>
						<div>Tên: ${row["Name"]}</div>
						<span style="font-size:20px;">&#9632;</span>: Điểm thực tế &nbsp &nbsp &nbsp
						<span style="font-size:15px;">&#11044;: Điểm tự đánh giá</span>
						<div style="padding-bottom:20px">
							<div style="height: 15px;" >
								<span class="icon" style="padding-left: ${tdpbPadding.expectedPadding}px; ">
									<span style="font-size:15px;">${row["Self-Assessment - Tư duy phản biện ( Critical Thinking)"]}</span>
									<br>
									<span style="font-size:14px;">&#11044;</span>
								</span>
								<br>
								<br>
							</div>
							
							<div class="flex-container">
								<span class="icon" style="padding-left: ${tdpbPadding.scorePadding}px; padding-top:5px">
									<span style="font-size:20px;">&#9632;</span>
									<br>
									<span style="font-size:15px;">${row["Skill Scores - Tư duy phản biện ( Critical Thinking)"]}</span>
								</span>
								<div style="font-size:14px;">Tư duy phản biện</div>
								<div style="background-color: red; margin-top: 5px;"></div>
								<div style="background-color: rgb(207, 153, 4); margin-top: 5px;"></div>
								<div style="background-color: green; margin-top: 5px;"></div>  
								
							</div>
						</div>

						<div style="padding-bottom:20px">
							<div style="height: 15px;" >
								<span class="icon" style="padding-left: ${sahPadding.expectedPadding}px; ">
									<span style="font-size:15px;">${row["Self-Assessment - Sức ảnh hưởng"]}</span>
									<br>
									<span style="font-size:14px;">&#11044;</span>
								</span>
								<br>
								<br>
							</div>
							
							<div class="flex-container">
								<span class="icon" style="padding-left: ${sahPadding.scorePadding}px; padding-top:5px">
									<span style="font-size:20px;">&#9632;</span>
									<br>
									<span style="font-size:15px;">${row["Skill Scores - Sức ảnh hưởng"]}</span>
								</span>
								<div style="font-size:14px;">Sức ảnh hưởng</div>
								<div style="background-color: red; margin-top: 5px;"></div>
								<div style="background-color: rgb(207, 153, 4); margin-top: 5px;"></div>
								<div style="background-color: green; margin-top: 5px;"></div>  
							</div>
						</div>

						<div style="padding-bottom:20px">
							<div style="height: 15px;" >
								<span class="icon" style="padding-left: ${kntuPadding.expectedPadding}px; ">
									<span style="font-size:15px;">${row["Self-Assessment - Khả năng thích ứng"]}</span>
									<br>
									<span style="font-size:14px;">&#11044;</span>
								</span>
								<br>
								<br>
							</div>
							
							<div class="flex-container">
								<span class="icon" style="padding-left: ${kntuPadding.scorePadding}px; padding-top:5px">
									<span style="font-size:20px;">&#9632;</span>
									<br>
									<span style="font-size:15px;">${row["Skill Scores - Khả năng thích ứng"]}</span>
								</span>
								<div style="font-size:14px;">Khả năng thích ứng</div>
								<div style="background-color: red; margin-top: 5px;"></div>
								<div style="background-color: rgb(207, 153, 4); margin-top: 5px;"></div>
								<div style="background-color: green; margin-top: 5px;"></div>  
							</div>
						</div>

						<div style="padding-bottom:20px">
							<div style="height: 15px;" >
								<span class="icon" style="padding-left: ${lvtnPadding.expectedPadding}px; ">
									<span style="font-size:15px;">${row["Self-Assessment - Kỹ năng Làm việc theo nhóm"]}</span>
									<br>
									<span style="font-size:14px;">&#11044;</span>
								</span>
								<br>
								<br>
							</div>
							
							<div class="flex-container">
								<span class="icon" style="padding-left: ${lvtnPadding.scorePadding}px; padding-top:5px">
									<span style="font-size:20px;">&#9632;</span>
									<br>
									<span style="font-size:15px;">${row["Skill Scores - Kỹ năng Làm việc theo nhóm"]}</span>
								</span>
								<div style="font-size:14px;">Kỹ năng làm việc theo nhóm</div>
								<div style="background-color: red; margin-top: 5px;"></div>
								<div style="background-color: rgb(207, 153, 4); margin-top: 5px;"></div>
								<div style="background-color: green; margin-top: 5px;"></div>  
							</div>
						</div>

						<div style="padding-bottom:20px">
							<div style="height: 15px;" >
								<span class="icon" style="padding-left: ${gtPadding.expectedPadding}px; ">
									<span style="font-size:15px;">${row["Self-Assessment - Kỹ năng Giao tiếp"]}</span>
									<br>
									<span style="font-size:14px;">&#11044;</span>
								</span>
								<br>
								<br>
							</div>
							
							<div class="flex-container">
								<span class="icon" style="padding-left: ${gtPadding.scorePadding}px; padding-top:5px">
									<span style="font-size:20px;">&#9632;</span>
									<br>
									<span style="font-size:15px;">${row["Skill Scores - Kỹ năng Giao tiếp"]}</span>
								</span>
								<div style="font-size:14px;">Kỹ năng giao tiếp</div>
								<div style="background-color: red; margin-top: 5px;"></div>
								<div style="background-color: rgb(207, 153, 4); margin-top: 5px;"></div>
								<div style="background-color: green; margin-top: 5px;"></div>  
							</div>
						</div>

						<div style="padding-bottom:20px">
							<div style="height: 15px;" >
								<span class="icon" style="padding-left: ${kxPadding.expectedPadding}px; ">
									<span style="font-size:15px;">${row["Self-Assessment - Kỹ năng Khởi xướng"]}</span>
									<br>
									<span style="font-size:14px;">&#11044;</span>
								</span>
								<br>
								<br>
							</div>
							
							<div class="flex-container">
								<span class="icon" style="padding-left: ${kxPadding.scorePadding}px; padding-top:5px">
									<span style="font-size:20px;">&#9632;</span>
									<br>
									<span style="font-size:15px;">${row["Skill Scores - Kỹ năng Khởi xướng"]}</span>
								</span>
								<div style="font-size:14px;">Kỹ năng khởi xướng</div>
								<div style="background-color: red; margin-top: 5px;"></div>
								<div style="background-color: rgb(207, 153, 4); margin-top: 5px;"></div>
								<div style="background-color: green; margin-top: 5px;"></div>  
							</div>
						</div>

						<div style="padding-bottom:20px">
							<div style="height: 15px;" >
								<span class="icon" style="padding-left: ${tcPadding.expectedPadding}px; ">
									<span style="font-size:15px;">${row["Self-Assessment - Kỹ năng tổ chức"]}</span>
									<br>
									<span style="font-size:14px;">&#11044;</span>
								</span>
								<br>
								<br>
							</div>
							
							<div class="flex-container">
								<span class="icon" style="padding-left: ${tcPadding.scorePadding}px; padding-top:5px">
									<span style="font-size:20px;">&#9632;</span>
									<br>
									<span style="font-size:15px;">${row["Skill Scores - Kỹ năng tổ chức"]}</span>
								</span>
								<div style="font-size:14px;">Kỹ năng tồ chức</div>
								<div style="background-color: red; margin-top: 5px;"></div>
								<div style="background-color: rgb(207, 153, 4); margin-top: 5px;"></div>
								<div style="background-color: green; margin-top: 5px;"></div>  
							</div>
						</div>
						
						<div style="padding-bottom:20px">
							<div style="height: 15px;" >
								<span class="icon" style="padding-left: ${gqvdPadding.expectedPadding}px; ">
									<span style="font-size:15px;">${row["Self-Assessment - Kỹ năng Giải quyết vấn đề"]}</span>
									<br>
									<span style="font-size:14px;">&#11044;</span>
								</span>
								<br>
								<br>
							</div>
							
							<div class="flex-container">
								<span class="icon" style="padding-left: ${gqvdPadding.scorePadding}px; padding-top:5px">
									<span style="font-size:20px;">&#9632;</span>
									<br>
									<span style="font-size:15px;">${row["Skill Scores - Kỹ năng Giải quyết vấn đề"]}</span>
								</span>
								<div style="font-size:14px;">Kỹ năng giải quyết vấn đề</div>
								<div style="background-color: red; margin-top: 5px;"></div>
								<div style="background-color: rgb(207, 153, 4); margin-top: 5px;"></div>
								<div style="background-color: green; margin-top: 5px;"></div>  
							</div>
						</div>
					</div>
				`;
			});
			document.getElementById('finalResult').innerHTML = tempHtml;
		}

		function caculatePadding(score, expectedScore) {
			let res = {
				scorePadding: 0,
				expectedPadding: 0,
			};
			if (score) res.scorePadding = score * 532 / 100 + 178;
			if (expectedScore) res.expectedPadding = expectedScore * 532 / 100 + 178;
			return res;
		}

		// function processCSV(data) {
			// ---------------------------------------------
			// var allTextLines = allText.split(/\r\n|\n/);
			// var headers = allTextLines[0].split(',');
			// console.log(headers);
			// var lines = [];

			// for (var i=1; i<allTextLines.length; i++) {
			// 	var data = allTextLines[i].split(',');
			// 	console.log(data);
			// 	var temp = {};
			// 	for (var j=0; j<headers.length; j++) {
			// 		if (j == 0) temp[headers[j]] = data[0] + data[1];
        	//        	temp[headers[j]] = data[j+1];
			// 	}
			// 	lines.push(temp);
        		
    		// }
			// console.log(lines);
		// }

	</script>
</html>